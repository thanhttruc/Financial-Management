---
alwaysApply: false
---
## 🧱 2. Backend Rules (NestJS)

### 📁 Folder Structure

```
src/
 ├── main.ts
 ├── app.module.ts
 ├── config/               # DB, CORS, env config
 ├── common/               # Decorators, guards, interceptors, utils
 ├── modules/              # Mỗi feature là 1 module riêng
 │    ├── user/
 │    │    ├── user.module.ts
 │    │    ├── user.controller.ts
 │    │    ├── user.service.ts
 │    │    ├── user.entity.ts
 │    │    ├── dto/
 │    │    └── interfaces/
 ├── filters/              # Exception filters
 ├── interceptors/         # Logging, response transform
 ├── database/             # ormconfig.ts
 └── main.ts
```

### 🧩 Rule chi tiết

* Mỗi module gồm:

  * `controller.ts`: xử lý HTTP request, gọi service.
  * `service.ts`: chứa logic nghiệp vụ.
  * `entity.ts`: ánh xạ bảng database.
  * `dto/`: định nghĩa request/response (dùng `class-validator`).
* Logic nghiệp vụ **chỉ nằm trong service**.
* Controller chỉ **nhận request → gọi service → trả response**.
* Dùng `Repository` pattern của TypeORM.
* Module chỉ import module cần thiết (tránh vòng lặp import).
* Config `.env` qua `@nestjs/config`.
* Response format thống nhất:

  ```ts
  return { success: true, message: 'User created', data: user };
  ```
* Viết unit test cơ bản cho service & controller.
